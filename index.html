<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Game</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            /* 画面スクロールを禁止 */
        }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        #player {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: red;
            cursor: pointer;
            user-select: none;
            /* テキスト選択を禁止 */
            touch-action: none;
            /* タッチ操作を無効化 */
        }

        .obstacle {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: blue;
        }

        #score {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            font-size: 24px;
        }
    </style>
</head>

<body>
    <div id="game-container">
        <div id="player"></div>
        <div id="score">Score: 0</div>
    </div>

    <script>
        var player = document.getElementById("player");
        var scoreElement = document.getElementById("score");
        var obstacles = [];
        var score = 0;
        var gameInterval;

        function createObstacle() {
            var obstacle = document.createElement("div");
            obstacle.className = "obstacle";
            obstacle.style.left = Math.floor(Math.random() * (window.innerWidth - 50)) + "px";
            obstacle.style.top = "-50px";
            document.getElementById("game-container").appendChild(obstacle);
            obstacles.push(obstacle);
        }

        function moveObstacles() {
            for (var i = obstacles.length - 1; i >= 0; i--) {
                var obstacle = obstacles[i];
                var obstacleTop = parseInt(obstacle.style.top);
                obstacle.style.top = obstacleTop + 5 + "px";

                if (obstacleTop > window.innerHeight) {
                    obstacle.parentNode.removeChild(obstacle);
                    obstacles.splice(i, 1);
                    score++;
                    scoreElement.innerText = "Score: " + score;
                }

                if (checkCollision(obstacle)) {
                    gameOver();
                    return;
                }
            }
        }

        function checkCollision(obstacle) {
            var playerRect = player.getBoundingClientRect();
            var obstacleRect = obstacle.getBoundingClientRect();
            return (
                playerRect.top < obstacleRect.bottom &&
                playerRect.bottom > obstacleRect.top &&
                playerRect.left < obstacleRect.right &&
                playerRect.right > obstacleRect.left
            );
        }

        function updatePlayerPosition(event) {
            var x;

            if (event.type === "mousemove") {
                x = event.clientX;
            } else if (event.type === "touchmove") {
                x = event.touches[0].clientX;
            }

            var playerWidth = parseInt(window.getComputedStyle(player).getPropertyValue("width"));
            var containerWidth = parseInt(window.getComputedStyle(document.getElementById("game-container")).getPropertyValue("width"));
            var maxX = containerWidth - playerWidth;

            player.style.left = Math.min(Math.max(x - playerWidth / 2, 0), maxX) + "px";
        }

        function startGame() {
            gameInterval = setInterval(moveObstacles, 10);
            document.addEventListener("mousemove", updatePlayerPosition);
            document.addEventListener("touchmove", updatePlayerPosition);
            createObstacle(); // Initial obstacle
        }

        function gameOver() {
            clearInterval(gameInterval);
            document.removeEventListener("mousemove", updatePlayerPosition);
            document.removeEventListener("touchmove", updatePlayerPosition);
            alert("Game Over! Your score: " + score);
            resetGame();
        }

        function resetGame() {
            obstacles.forEach(function (obstacle) {
                obstacle.parentNode.removeChild(obstacle);
            });
            obstacles = [];
            score = 0;
            scoreElement.innerText = "Score: " + score;
            createObstacle();
        }

        startGame();
    </script>
</body>

</html>